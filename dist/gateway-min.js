var LDGATEWAY=function(t,e,n){return{GATEWAY:".gateway-modal",GATEWAY_OPEN_CLASS:"gateway-modal--active",attemptsAmount:0,inputElements:".label",errorClass:"input--is-error",successClass:"input--is-success",button:".gw-button--for-action",tryAgainButton:".gw-content__error-btn-for-action",successButton:".gw-success__action-btn-for-action",termsAndConditionElement:{el:".gw-form__input--checkbox",label:".gw-form__checkbox-plug","data-element-validate-status":"error",currentValue:!1,reg:null},cardBrands:[{alias:"visa",name:"Visa",codeName:"CVV",codeLength:3,gaps:[4,8,12],lengths:[16],pattern:/^4\d*$/},{alias:"mastercard",name:"MasterCard",codeName:"CVC",codeLength:3,gaps:[4,8,12],lengths:[16],pattern:/^(5[1-5]|222[1-9]|2[3-6]|27[0-1]|2720)\d*$/},{alias:"amex",name:"American Express",codeName:"CID",codeLength:4,gaps:[4,10],lengths:[15],pattern:/^3[47]\d*$/},{alias:"diners",name:"Diners Club",codeName:"CVV",codeLength:3,gaps:[4,10],lengths:[14],pattern:/^3(0[0-5]|[689])\d*$/},{alias:"discover",name:"Discover",codeName:"CID",codeLength:3,gaps:[4,8,12],lengths:[16,19],pattern:/^(6011|65|64[4-9])\d*$/},{alias:"jcb",name:"JCB",codeName:"CVV",codeLength:3,gaps:[4,8,12],lengths:[16],pattern:/^(2131|1800|35)\d*$/},{alias:"unionpay",name:"UnionPay",codeName:"CVN",codeLength:3,gaps:[4,8,12],lengths:[16,17,18,19],pattern:/^62[0-5]\d*$/},{alias:"maestro",name:"Maestro",codeName:"CVC",codeLength:3,gaps:[4,8,12],lengths:[12,13,14,15,16,17,18,19],pattern:/^(5[0678]|6304|6390|6054|6271|67)\d*$/},{alias:"mir",name:"MIR",codeName:"CVC",codeLength:3,gaps:[4,8,12],lengths:[16],pattern:/^22\d*$/}],cardInputElement:{el:".gw-form__input--card",label:".gw-form__label--card","data-element-validate-status":"error",currentValue:"",reg:null,len:null},fieldsData:[{el:".gw-form__input--date-mm",label:".gw-form__label--date-mm",reg:/^[0-9]{1,2}$/gi,"data-element-validate-status":"error",currentValue:""},{el:".gw-form__input--date-yy",label:".gw-form__label--date-yy",reg:/^[0-9]{2,4}$/gi,"data-element-validate-status":"error",currentValue:""},{el:".gw-form__input--cvv",label:".gw-form__label--cvv",reg:/^[0-9]{3,4}$/gi,"data-element-validate-status":"error",currentValue:""},{el:".gw-form__input--name",label:".gw-form__label--name",reg:/^([a-zA-Z]+)\s([a-zA-Z]+)$/gi,"data-element-validate-status":"error",currentValue:""}],statuses:[],st:[],tokenTabClass:".gw-content__token-item",tokenTabActiveClass:"gw-content__token-item--is-active",tokenTabData:"data-token-tab-id",tokenActionButton:".gw-token__next-button-for-action",closedElements:".gw-benefits__close-icon-mobile, .gw-benefits__close-icon",currentTokenTabActive:"1",isNth1Checked:!1,paths:{verify:"age/verify",decline:"age/oneclick_card"},currentConsistent:{mode:"desktop",submode:"token",tokensAmount:null},controllers:function(){var e=this;e.setFieldsControllers(),t(window).resize(function(){var n=t(window).width();e.setGatewayMode(n)}),t(document).on("click",e.closedElements,function(){e.closeGateway()}),t(document).on("click",e.tryAgainButton,function(){event.preventDefault(),Gl.SendGoalEvent("CLICK_TRY_AGAIN_LTM",{tid:__globalTagId__}),e.setGatewaySubMode(t(window).width(),"form")}),t(document).on("click",e.successButton,function(){Gl.SendGoalEvent("TICK_ON_UPGRADE",_access3),this.isNth1Checked||t(".recharge__input-nth2").prop("checked")?window.location.href=site_url+"age/upgrade":window.location.href=site_url+""}),t(document).on("click",e.tokenActionButton,function(){e.currentConsistent.submode="form",e.setGatewaySubMode(t(window).width(),e.currentConsistent.submode),e.setTokensAmount()}),t(document).on("click",e.tokenTabClass,function(){t(e.tokenTabClass).removeClass(e.tokenTabActiveClass),t(this).addClass(e.tokenTabActiveClass),e.currentTokenTabActive=t(this).attr(e.tokenTabData),e.setTokensAmount()}),t(e.button).on("click",function(){e.setNth1Check();var t=new n({type:"proc",iconClass:"send-animation",elLink:e.button});e.statuses=[],e.fieldsData.forEach(function(t){e.checkAllFields(),e.checkedField(t),e.removeActiveClasses(t),"success"===t["data-element-validate-status"]?e.statuses.push("success"):"error"===t["data-element-validate-status"]&&e.statuses.push("error")}),e.validateCardData(e.cardInputElement),e.validateTermsAndConditionCheckbox(),t.startAnimation(),-1!==e.statuses.indexOf("error")?(e.statuses=[],e.attemptsAmount+=1,e.fieldsData.forEach(function(t){e.checkedField(t)}),e.checkedField(e.cardInputElement),e.checkedTermsAndConditionCheckbox()):(e.sendData(t),console.log("send!"))}),t(e.termsAndConditionElement.el).on("change",function(){e.termsAndConditionElement.currentValue=t(this).prop("checked"),e.checkedTermsAndConditionCheckbox()})},sendData:function(e){var n=this,a=this.getCrosses(),i=this.getData();i.xsales=a;var s=this.getPath();n.getCheckBoxStatuses(),t("#thmContainer").load(site_url+"age/thm",function(){i.thmSessionId=t("#thm_session_id").val(),__private_content_data__&&(i.content=__private_content_data__),t.ajax({url:site_url+s,type:"POST",data:JSON.stringify(i),contentType:"application/json; charset=utf-8",dataType:"json",beforeSend:function(e){t(".button-check-card").prop("disabled",!0)}}).done(function(a){e.stopAnimation(),a.result?"decline"===n.currentConsistent.mode?(closeGateway(),__lookachat__.removeBanner("main",t(".gateway-modal__content").attr("data-decline-user-id"),0)):(n.setNth2Check(),n.setGatewaySubMode(t(window).width(),"success")):"decline"===n.currentConsistent.mode?n.setGatewaySubMode(t(window).width(),"form"):showError()}).fail(function(a,i){e.stopAnimation(),n.setGatewaySubMode(t(window).width(),"err")})})},open:function(e){if(e)for(var n in e)e.hasOwnProperty(n)&&(this.currentConsistent[n]=e[n]);this.setGatewayMode(t(window).width(),this.currentConsistent.mode),this.setGatewaySubMode(t(window).width(),this.currentConsistent.submode),t(this.GATEWAY).addClass(this.GATEWAY_OPEN_CLASS)},closeGateway:function(){t(this.GATEWAY).removeClass(this.GATEWAY_OPEN_CLASS)},getCheckBoxStatuses:function(){var e,n,a=t("#access1").prop("checked"),i=t("#access2").prop("checked"),s=t("#access3").prop("checked"),o=t("#acceptTerms").prop("checked")?"1":"0";"1"===o&&(Gl.SendGoalEvent("TICK_ON_TERMS",{pd:o,tid:__globalTagId__}),e=a?"1":"0",n=i?"1":"0",s?"1":"0",Gl.SendGoalEvent("TICK_ON_1001DVD",{pd:e,tid:__globalTagId__}),Gl.SendGoalEvent("TICK_ON_JAVHD",{pd:n,tid:__globalTagId__}))},getPath:function(){return"decline"===this.currentConsistent.mode?this.paths.decline:this.paths.verify},getData:function(){var e=+t(".gw-form__input--date-mm").val()<10?"0"+t(".gw-form__input--date-mm").val():+t(".gw-form__input--date-mm").val();return{number:t(".gw-form__input--card").val().split(" ").join(""),holder:t(".gw-form__input--name").val(),exp:e+"20"+t(".gw-form__input--date-yy").val(),cvv:t(".gw-form__input--cvv").val()}},getCrosses:function(){var e=[];return t("#access1").prop("checked")&&e.push(t("#access1").val()),t("#access2").prop("checked")&&e.push(t("#access2").val()),t("#access3").prop("checked")&&e.push(t("#access3").val()),"decline"===this.currentConsistent.mode?[]:e},setNth1Check:function(){var e=t(".recharge__input-nth1").prop("checked");this.isNth1Checked=e},setNth2Check:function(){this.isNth1Checked&&(t(".recharge-nth2").hide(),t(".added-content-nth2").hide())},setTokensAmount:function(){var e=this;t("[data-token-tab-id]").each(function(){t(this).attr("data-token-tab-id")===e.currentTokenTabActive&&(e.currentConsistent.tokensAmount=t(this).attr("data-tokens-amount"),t("._tokens-amount").text(e.currentConsistent.tokensAmount))})},setGatewayMode:function(e,n){e>=935&&(this.currentConsistent.mode="desktop"),e>=635&&e<935&&(this.currentConsistent.mode="tablet"),e<635&&(this.currentConsistent.mode="mobile"),n?t(".gateway-modal").attr("data-is-device-mode",n):t(".gateway-modal").attr("data-is-device-mode",this.currentConsistent.mode)},setGatewaySubMode:function(e,n){e<635&&null===this.currentConsistent.submode&&(this.currentConsistent.submode="token"),t(".gateway-modal").attr("data-is-device-submode",this.currentConsistent.submode),n&&t(".gateway-modal").attr("data-is-device-submode",n)},catchChangeYYMM:function(){var t=this;t.attemptsAmount>0&&(t.checkAllFields(),t.fieldsData.forEach(function(e){t.checkedField(e)}))},setActiveTab:function(){var e=this;t(e.tokenTabClass).each(function(){t(this).attr(e.tokenTabData)===e.currentTokenTabActive&&t(this).addClass(e.tokenTabActiveClass)})},validateTermsAndConditionCheckbox:function(){this.checkedTermsAndConditionCheckbox(),this.removeActiveClasses(this.termsAndConditionElement)},checkedTermsAndConditionCheckbox:function(){var e=t(this.termsAndConditionElement.label);this.termsAndConditionElement.currentValue?(this.termsAndConditionElement["data-element-validate-status"]="success",e.addClass(this.successClass),this.statuses.push("success")):(this.termsAndConditionElement["data-element-validate-status"]="error",e.addClass(this.errorClass),this.statuses.push("error"))},validateCardData:function(t){this.checkedField(t),this.removeActiveClasses(t),"success"===t["data-element-validate-status"]?this.statuses.push("success"):"error"===t["data-element-validate-status"]&&this.statuses.push("error")},checkAllFields:function(){this.fieldsData.forEach(function(e,n){e.currentValue=t(e.el).val()})},setFieldsControllers:function(){var n=this;this.fieldsData.forEach(function(e,a){t(e.el).on("keyup",function(a){e.currentValue=t(e.el).val(),0!==n.attemptsAmount&&n.checkedField(e)})}),0!==n.attemptsAmount&&n.validateCardData(n.cardInputElement);new e(n.cardInputElement.el,{creditCard:!0,onCreditCardTypeChanged:function(t){},onValueChanged:function(e){var a=n.validateCardNumber(n.cardBrands,e.target.rawValue),i=e.target.rawValue;n.cardInputElement.currentValue=i,a.f&&"none"!==a.i&&(n.cardInputElement.reg=n.cardBrands[a.i].pattern,n.cardInputElement.len=n.cardBrands[a.i].lengths[0],e.target.rawValue.length<n.cardBrands[a.i].lengths[0]?n.cardInputElement["data-element-validate-status"]="error":e.target.rawValue.length>=n.cardBrands[a.i].lengths[0]?n.cardInputElement["data-element-validate-status"]="success":n.cardInputElement["data-element-validate-status"]="error"),a.f&&"none"===a.i&&t(n.cardInputElement.el).attr("data-validation","success"),0!==n.attemptsAmount&&n.checkedField(n.cardInputElement),n.checkAllFields()}})},validateCardNumber(t,e){var n,a=t.find(function(t,n){if(t.pattern.test(e))return t});return n=a?t.findIndex(function(t){return t.alias===a.alias}):"none",{f:!!a,i:n}},checkedField:function(t){this.setValidate(t,this.validateField(t))},setValidate:function(e,n){this.removeActiveClasses(e),"success"===n?t(e.label).addClass(this.successClass):"error"===n&&t(e.label).addClass(this.errorClass)},removeActiveClasses:function(e){t(e.label).removeClass(this.successClass),t(e.label).removeClass(this.errorClass)},validateField:function(t){return-1!==t.currentValue.search(t.reg)&&""!==t.currentValue?t.len&&t.currentValue.length<t.len?(t["data-element-validate-status"]="error","error"):(t["data-element-validate-status"]="success","success"):(t["data-element-validate-status"]="error","error")},init:function(){this.catchChangeYYMM=this.catchChangeYYMM.bind(this),this.controllers(),this.setActiveTab(),this.setTokensAmount(),this.setGatewayMode(t(window).width()),this.setGatewaySubMode(t(window).width(),this.currentConsistent.submode)}}}($,Cleave,ButtonState);function ButtonState(t){this.uniqClass=t.iconClass||"_animation-icon",this.type=t.type,this.el=t.elLink,this.innerElements=Object.create(null),this.innerElements.arrow='<svg viewBox="0 0 24 24"><path d="M19,8L15,12H18A6,6 0 0,1 12,18C11,18 10.03,17.75 9.2,17.3L7.74,18.76C8.97,19.54 10.43,20 12,20A8,8 0 0,0 20,12H23M6,12A6,6 0 0,1 12,6C13,6 13.97,6.25 14.8,6.7L16.26,5.24C15.03,4.46 13.57,4 12,4A8,8 0 0,0 4,12H1L5,16L9,12"></path></svg>',this.innerElements.stop='<svg width="24" height="24" viewBox="0 0 24 24"><path d="M12,0A12,12 0 0,1 24,12A12,12 0 0,1 12,24A12,12 0 0,1 0,12A12,12 0 0,1 12,0M12,2A10,10 0 0,0 2,12C2,14.4 2.85,16.6 4.26,18.33L18.33,4.26C16.6,2.85 14.4,2 12,2M12,22A10,10 0 0,0 22,12C22,9.6 21.15,7.4 19.74,5.67L5.67,19.74C7.4,21.15 9.6,22 12,22Z"></path></svg>',this.innerElements.star='<svg width="24" height="24" viewBox="0 0 24 24"><path d="M12,17.27L18.18,21L16.54,13.97L22,9.24L14.81,8.62L12,2L9.19,8.62L2,9.24L7.45,13.97L5.82,21L12,17.27Z"</path></svg>',this.innerElements.proc='<span>Processing</span><span class="gw-button__dot"></span><span class="gw-button__dot"></span><span class="gw-button__dot"</span>',this.buttonLink=null,this.buttonHeight=null,this.buttonContent="",this.stopAnimationCallback=function(){},this.startAnimationCallback=function(){}}function _instanceof(t,e){return null!=e&&"undefined"!=typeof Symbol&&e[Symbol.hasInstance]?e[Symbol.hasInstance](t):t instanceof e}function _toConsumableArray(t){return _arrayWithoutHoles(t)||_iterableToArray(t)||_nonIterableSpread()}function _nonIterableSpread(){throw new TypeError("Invalid attempt to spread non-iterable instance")}function _iterableToArray(t){if(Symbol.iterator in Object(t)||"[object Arguments]"===Object.prototype.toString.call(t))return Array.from(t)}function _arrayWithoutHoles(t){if(Array.isArray(t)){for(var e=0,n=new Array(t.length);e<t.length;e++)n[e]=t[e];return n}}function _classCallCheck(t,e){if(!_instanceof(t,e))throw new TypeError("Cannot call a class as a function")}function _defineProperties(t,e){for(var n=0;n<e.length;n++){var a=e[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(t,a.key,a)}}function _createClass(t,e,n){return e&&_defineProperties(t.prototype,e),n&&_defineProperties(t,n),t}LDGATEWAY.init(),ButtonState.prototype.getElementContainer=function(t){return"<span class="+this.uniqClass+' style="position: absolute;top: 50%; left: 50%; transform: translate(-50%, -50%);display:flex; align-items: center">'+t+"</span>"},ButtonState.prototype.setIcon=function(t,e){this.innerElements[t]=e},ButtonState.prototype.getButtonElement=function(t){this.buttonLink=document.querySelector(t),this.buttonContent=this.buttonLink.innerHTML,this.buttonHeight=this.buttonLink.offsetHeight},ButtonState.prototype.startAnimation=function(t){this.getButtonElement(this.el),this.buttonLink.innerHTML=t?this.getElementContainer(this.innerElements[t]):this.getElementContainer(this.innerElements[this.type]),this.buttonLink.setAttribute("disabled",!0),this.buttonLink.style.height=this.buttonHeight+"px",this.startAnimationCallback()},ButtonState.prototype.stopAnimation=function(t){this.buttonLink.innerHTML=this.buttonContent,this.buttonLink.removeAttribute("disabled"),this.buttonLink.style.height="40px",this.stopAnimationCallback()},ButtonState.prototype.setStartAnimationCallback=function(t){this.startAnimationCallback=t},ButtonState.prototype.setStopAnimationCallback=function(t){this.stopAnimationCallback=t};var DataPicker=function(){function t(e){_classCallCheck(this,t),this.inputElement=e.inputElement,this.buttonElement=e.buttonElement,this.parent=e.parent,this.morph=e.morph||{data:"year"},this.containerID=null,this.uniqContainerClass=null,this.uniqCellClass=null,this.bridgeElementValue=null,this.currentValue=null,this.getCurrentValue=this.getCurrentValue.bind(this),this.getBridgedElementValue=function(){return{value:this.currentValue,container:this.uniqContainerClass}},this.changeCallback=function(){},this.init()}return _createClass(t,[{key:"setController",value:function(){var t=this,e=this;$(document).on("click",this.buttonElement,function(){t.createPickerBlock(t.getCells(t.createInterval())),$(".".concat(t.getBridgedElementValue().container)).removeClass("data-picker-container--active");var e=$(".".concat(t.uniqContainerClass)),n=(e.outerWidth(!0),e.outerHeight(!0)),a={top:t.getButtonElementsCoordinaties().top+n/13,left:t.getButtonElementsCoordinaties().left-1};e.addClass("data-picker-container--active"),e.offset(a)}),$(document).on("click",".".concat(e.uniqCellClass),function(n){n.preventDefault(),n.stopPropagation(),e.currentValue=$(this).attr("data-dp-cell"),"year"===t.morph.data?$(e.inputElement).attr("value",e.currentValue-2e3):$(e.inputElement).attr("value",e.currentValue),t.changeCallback(),$(".".concat(e.uniqContainerClass)).removeClass("data-picker-container--active"),$(".".concat(e.uniqContainerClass)).css({display:"none"})}),$(document).on("focus",e.inputElement,function(){$(this).blur()})}},{key:"changeBridge",value:function(t){this.changeCallback=t}},{key:"createPickerBlock",value:function(t){var e=this.getDataElement({name:"div",attributes:{class:"data-picker-container ".concat(this.uniqContainerClass),"data-dp-container":"".concat(this.containerID)},childs:_toConsumableArray(t).reverse()});$(".".concat(this.uniqContainerClass)).remove(),$(this.parent).append(e)}},{key:"createCell",value:function(t){return this.getDataElement({name:"button",attributes:{class:"data-picker-cell ".concat(this.uniqCellClass),"data-dp-cell":t,tabindex:"2"},value:"year"===this.morph.data?t-2e3:t})}},{key:"getCells",value:function(t){for(var e=t.min,n=t.max,a=[],i=e;i<=n;i++)a.push(this.createCell(i));return a}},{key:"createInterval",value:function(){var t=this.getCurrentDate(),e=this.morph.data,n=null,a=null,i=this.getBridgedElementValue().value;return"year"===e&&(null===i&&(a=(n=t.year)+10),i>t.month&&(a=(n=t.year)+this.morph.interval),i<=t.month&&null!==i&&(a=(n=t.year+1)+this.morph.interval)),"month"===e&&(null===i?(n=1,a=12):i>t.year&&(n=1,a=12),i<=t.year&&null!==i&&(n=t.month+1,a=12)),{min:n,max:a}}},{key:"getUniqueValue",value:function(){for(var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:6,e="asdfghjzxcvbnmkqwertyuiop".split(""),n="",a=0;a<t;a++)n+=e[Math.floor(Math.random()*e.length)];this.containerID=n,this.uniqContainerClass="data-picker-container__uq".concat(this.containerID),this.uniqCellClass="data-picker-cell__uq".concat(this.containerID)}},{key:"getDataElement",value:function(t){var e=t.name,n=t.attributes,a=t.value,i=t.childs,s=document.createElement(e);if(n)for(var o in n)s.setAttribute(o,n[o]);return a&&(s.innerHTML=a),i&&0!==i.length&&i.forEach(function(t){return s.appendChild(t)}),s}},{key:"getCurrentDate",value:function(){var t=new Date;return{year:t.getFullYear(),month:t.getMonth()+1}}},{key:"getButtonElementsCoordinaties",value:function(){return $(this.buttonElement).offset()}},{key:"bridge",value:function(t){this.getBridgedElementValue=t}},{key:"getCurrentValue",value:function(){return{value:this.currentValue,container:this.uniqContainerClass}}},{key:"init",value:function(){this.getUniqueValue(),this.setController()}}]),t}(),year=new DataPicker({inputElement:".gw-form__input--date-yy",buttonElement:".field-part__plug-year",parent:".gw-form__label--date-yy",morph:{data:"year",interval:10}}),month=new DataPicker({inputElement:".gw-form__input--date-mm",buttonElement:".field-part__plug-month",parent:".gw-form__label--date-mm",morph:{data:"month"}});function Confetti(){var t=document.querySelector(".confetti"),e=t.getContext("2d"),n=window.innerWidth,a=window.innerHeight;t.width=n,t.height=a;for(var i=150,s=["circle","circle","triangle","triangle","line"],o=[[238,96,169],[68,213,217],[245,187,152],[144,148,188],[235,234,77]],r=[[4,0,4,4],[2,2,0,4],[0,4,2,2],[0,4,4,4]],l=[],c=0;c<i;c++)l.push({x:Math.random()*n,y:Math.random()*a,r:4*Math.random()+1,d:Math.random()*i,l:Math.floor(65*Math.random()-30),a:r[Math.floor(Math.random()*r.length)],c:o[Math.floor(Math.random()*o.length)],t:s[Math.floor(Math.random()*s.length)]});setInterval(function(){e.clearRect(0,0,n,a);for(var t=0;t<i;t++){var s=l[t],o=s.r<=3?.4:.8;"circle"==s.t?(e.fillStyle="rgba("+s.c+", "+o+")",e.beginPath(),e.moveTo(s.x,s.y),e.arc(s.x,s.y,s.r,0,2*Math.PI,!0),e.fill()):"triangle"==s.t?(e.fillStyle="rgba("+s.c+", "+o+")",e.beginPath(),e.moveTo(s.x,s.y),e.lineTo(s.x+s.r*s.a[0],s.y+s.r*s.a[1]),e.lineTo(s.x+s.r*s.a[2],s.y+s.r*s.a[3]),e.closePath(),e.fill()):"line"==s.t&&(e.strokeStyle="rgba("+s.c+","+o+")",e.beginPath(),e.moveTo(s.x,s.y),e.lineTo(s.x+s.l,s.y+5*s.r),e.lineWidth=2,e.stroke())}!function(){for(var t=0;t<i;t++){var e=l[t];e.y+=Math.cos(e.d)+1+e.r/2,e.x+=2*Math.sin(0),(e.x>n+5||e.x<-5||e.y>a)&&(l[t]={x:Math.random()*n,y:-10,r:e.r,d:e.d,l:e.l,a:e.a,c:e.c,t:e.t})}}()},23)}year.bridge(month.getCurrentValue),month.bridge(year.getCurrentValue),year.changeBridge(LDGATEWAY.catchChangeYYMM),month.changeBridge(LDGATEWAY.catchChangeYYMM),window.onload=function(){Confetti()},$(".op").on("click",function(){LDGATEWAY.open({mode:"desctop",submode:"token"})});